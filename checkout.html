<!DOCTYPE html>
<html lang="zxx" class="no-js">

<head>
<!-- Mobile Specific Meta -->
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Favicon-->
	<link rel="shortcut icon" href="img/trendykickslogo.jpg">
	<!-- Author Meta -->
	<meta name="author" content="Sole Seeker Team">
	<!-- Meta Description -->
	<meta name="description" content="">
	<!-- Meta Keyword -->
	<meta name="keywords" content="">
	<!-- meta character set -->
	<meta charset="UTF-8">
	<!-- Site Title -->
	<title>Trendy Kicks</title>

    <!--
            CSS
            ============================================= -->
    <link rel="stylesheet" href="css/linearicons.css">
    <link rel="stylesheet" href="css/owl.carousel.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/nice-select.css">
    <link rel="stylesheet" href="css/nouislider.min.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/main.css">

  
      
</head>

<body>

    <!-- Start Header Area -->
	<header class="header_area sticky-header">
		<div class="main_menu">
			<nav class="navbar navbar-expand-lg navbar-light main_box">
				<div class="container">
					<!-- Brand and toggle  // FULLSTACK-CODED BY: Christian Lei Batuhan Gigje (https://facebook.com/leiikun.me)get grouped for better mobile display -->
					<a class="navbar-brand logo_h" href="index.html"><img src="img/trendykickslogo.jpg" width="120px" height="100px"></a>
					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
					 aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse offset" id="navbarSupportedContent">
						<ul class="nav navbar-nav menu_nav ml-auto">
							<li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                            <li class="nav-item"><a class="nav-link" href="category.html">Shop</a></li>
							
                    <!--Navigation Bar other contents
							<li class="nav-item submenu dropdown">
								<a href="category.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
								 aria-expanded="false">Shop</a>
								<ul class="dropdown-menu">
									<li class="nav-item"><a class="nav-link" href="category.html">Shop Category</a></li>
									<li class="nav-item"><a class="nav-link" href="single-product.html">Product Details</a></li>
									<li class="nav-item"><a class="nav-link" href="checkout.html">Product Checkout</a></li>
									<li class="nav-item"><a class="nav-link" href="cart.html">Shopping Cart</a></li>
									<li class="nav-item"><a class="nav-link" href="confirmation.html">Confirmation</a></li>
								</ul>
							</li>
						-->

							<li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
						</ul>
						<ul class="nav navbar-nav navbar-right">
							<li class="nav-item"><a href="cart.html" class="cart"><span class="ti-shopping-cart"></span></a></li>
							<li class="nav-item" id="profilevisit"><a href="javascript:void(0)"><span class="lnr lnr-user"></span></a></li>
						</ul>
					</div>
				</div>
			</nav>
		</div>
	</header>
	<!-- End Header Area -->

    <!-- Start Banner Area -->
    <section class="banner-area organic-breadcrumb">
        <div class="container">
            <div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
                <div class="col-first">
                    
                    <h1 style="color: orange; text-shadow: 2px 2px #ffffff; font-size: 50px;">Checkout</h1>
                    <nav class="d-flex align-items-center">
                        <a href="index.html" style="color: orange; text-shadow: 2px 2px #ffffff; font-size: 25px;">Home<span class="lnr lnr-arrow-right"></span></a>
                        <a href="single-product.html" style="color: orange; text-shadow: 2px 2px #ffffff; font-size: 25px;">Checkout</a>
                    </nav>
                </div>
            </div>
        </div>
    </section>
    <!-- End Banner Area -->

    <!--================Checkout Area =================-->
    <section class="checkout_area section_gap">
        <div class="container">
            <div class="returning_customer" id="returningCustomer">
                <div class="check_title">
                    <h2>Returning Customer? <a href="#">Click here to login</a></h2>
                </div>
                <p>If you have shopped with us before, please enter your details in the boxes below. If you are a new
                    customer, please proceed to the Billing & Shipping section.</p>
                <form class="row contact_form" action="#" method="post" novalidate="novalidate">
                    <div class="col-md-6 form-group p_star">
                        <input type="text" class="form-control" id="name" name="name">
                        <span class="placeholder" data-placeholder="Username or Email"></span>
                    </div>
                    <div class="col-md-6 form-group p_star">
                        <input type="password" class="form-control" id="password" name="password">
                        <span class="placeholder" data-placeholder="Password"></span>
                    </div>
                    <div class="col-md-12 form-group">
                        <button type="submit" value="submit" class="primary-btn">login</button>
                        <div class="creat_account">
                            <input type="checkbox" id="f-option" name="selector">
                            <label for="f-option">Remember me</label>
                        </div>
                        <a class="lost_pass" href="#">Lost your password?</a>
                    </div>
                </form>
            </div>
            <div class="cupon_area">
                <div class="check_title">
                    <h2>Have a coupon? <a href="#">Click here to enter your code</a></h2>
                </div>
                <input type="text" placeholder="Enter coupon code">
                <a class="tp_btn" href="#">Apply Coupon</a>
            </div>
            <div class="billing_details">
                <div class="row">
                    <div class="col-lg-8">
                        <h3>Billing Details</h3>
                        <form class="row contact_form" action="#" method="post" novalidate="novalidate">
                            <div class="col-md-6 form-group p_star">
                                <input type="text" class="form-control" id="first" name="first" placeholder="First Name*" required>
                            </div>
                            <div class="col-md-6 form-group p_star">
                                <input type="text" class="form-control" id="last" name="last" placeholder="Last name*" required>
                            </div>
                            <div class="col-md-12 form-group">
                                <input type="text" class="form-control" id="company" name="company" placeholder="Company name">
                            </div>
                            <div class="col-md-6 form-group p_star">
                                <input type="text" class="form-control" id="number" name="number" placeholder="Phone number*" required>
                            </div>
                            <div class="col-md-6 form-group p_star">
                                <input type="text" class="form-control" id="email" name="email" placeholder="Email Address*" required>
                            </div>


                            <div class="col-md-12 form-group p_star">
                                <select class="country_select" id="country1" title="Country*" name="country1" onchange="countryC()" required>
                                    <option value="" disabled selected>Select a Country</option>
                                    <option value="Philippines">Philippines</option>
                                </select>
                            </div>



                            <div class="col-md-12 form-group p_star">
                                <input type="text" class="form-control" id="add1" name="add1" placeholder="Address line*" required>
                            </div>
                            <div class="col-md-12 form-group p_star">
                                <input type="text" class="form-control" id="city" name="city" placeholder="Town/City*" required>
                            </div>



                            <div class="col-md-12 form-group p_star">
                                <select class="country_select" id="province" title="Province*" name="province" required>
                                    <option value="" disabled selected>Select a Province</option>
                                    <optgroup label="Philippines">
                                        <option value="Metro Manila">Metro Manila</option>
                                        <option value="Cebu">Cebu</option>
                                        <option value="Davao">Davao</option>
                                        <option value="Benguet">Benguet</option>
                                        <option value="Pampanga">Pampanga</option>
                                        <option value="Cavite">Cavite</option>
                                        <option value="Laguna">Laguna</option>
                                        <option value="Rizal">Rizal</option>
                                        <option value="Iloilo">Iloilo</option>
                                        <option value="Batangas">Batangas</option>
                                    </optgroup>
                                </select>
                            </div>
                            


                            <div class="col-md-12 form-group">
                                <input type="text" class="form-control" id="zip" name="zip" placeholder="Postcode/ZIP*" required>
                            </div>
                            <div class="col-md-12 form-group">
                                <div class="creat_account1" id="creat_account1">
                                    <input type="checkbox" id="f-option2" name="selector">
                                    <label for="f-option2">Create an account?</label>
                                </div>
                            </div>
                            <div class="col-md-12 form-group">
                                <div class="creat_account">
                                    <h3>Shipping Details</h3>
                                    <input type="checkbox" id="f-option3" name="selector">
                                    <label for="f-option3">Ship to a different address?</label>
                                </div>
                                <textarea class="form-control" name="message" id="message" rows="1" placeholder="Order Notes"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="col-lg-4">
                        <div class="order_box">
                            <h2>Your Order</h2>
                            <ul class="list">
                                <li><a href="javascript:void(0)">Product <span>Total</span></a></li>
                                <script>
                                    //get data from local storage and display it in the cart
                                    var cart = JSON.parse(localStorage.getItem("cart"));
                                    var total = 0;
                                    for (var i = 0; i < cart.length; i++) {
                                        var item = cart[i];
                                        var name = item.name;
                                        
                                        var price = parseFloat(item.price.replace(/,/g, ''));
                                        
                                        var quantity = item.quantity;
                                        var subtotal = price * quantity;
                                        total += subtotal;
                                        
                                        subtotal = subtotal.toLocaleString('en-US', { style: 'currency', currency: 'PHP' });
                                
                                        document.write("<li><a href='javascript:void(0)'>" + name + "<span class='middle'>x " + quantity + "</span> <span class='last'>" + subtotal + "</span></a></li>");
                                    }
                                </script>
                                
                                

                            </ul>
                            <ul class="list list_2">
                                <script>
                                    //get data from local storage and calculate the subtotal
                                    var cart = JSON.parse(localStorage.getItem("cart"));
                                    var total = 0;
                                    for (var i = 0; i < cart.length; i++) {
                                        var item = cart[i];
                                        var price = parseFloat(item.price.replace(/,/g, ''));
                                        var quantity = item.quantity;
                                        var subtotal = price * quantity;
                                        total += subtotal;
                                    }
                                
                                    var shipping = 0;
                                
                                    //function to calculate and update the shipping cost
                                    function countryC() {
                                        var selectedCountry = document.getElementById("country1").value;
                                        var shippingCost = 0;
                                
                                        switch (selectedCountry) {
                                            
                                            case "Philippines":
                                                shippingCost = 150; 
                                                break;
                                            case "India":
                                                shippingCost = 550; 
                                                break;
                                            case "Japan":
                                                shippingCost = 800; 
                                                break;
                                            default:
                                                shippingCost = 0; //default shipping cost
                                        }
                                
                                        var totalWithShipping = total + shippingCost;
                                
                                        document.getElementById("shippingCost").textContent = shippingCost.toLocaleString('en-US', { style: 'currency', currency: 'PHP' });
                                        document.getElementById("totalWithShipping").textContent = totalWithShipping.toLocaleString('en-US', { style: 'currency', currency: 'PHP' });
                                    }
                                
                                    var totalWithShipping = total + shipping;
                                    document.write("<li><a href='javascript:void(0)'>Subtotal <span>" + total.toLocaleString('en-US', { style: 'currency', currency: 'PHP' }) + "</span></a></li>");
                                    document.write("<li><a href='javascript:void(0)'>Shipping<span id='shippingCost'> Flat Rate: ₱" + 100 + "</span></a></li>");
                                    document.write("<li><a href='javascript:void(0)'>Total <span id='totalWithShipping'>" + totalWithShipping.toLocaleString('en-US', { style: 'currency', currency: 'PHP' }) + "</span></a></li>");
                                </script>
                                
                                
                            </ul>



                            <div class="payment_item">
                                <div class="radion_btn">
                                    <input type="radio" id="f-option5" name="payment" >
                                    <label for="f-option5">Cash on Delivery</label>
                                    <div class="check"></div>
                                </div>
                                <p>Pay upon delivered</p>
                            </div>
                            
                            <div class="payment_item">
                                <div class="radion_btn">
                                    <input type="radio" id="f-option7" name="payment">
                                    <label for="f-option7">E-Wallet Payments</label>
                                    <div class="check"></div>
                                </div>
                                <p>You can pay with your e-wallet online payments such as GCash, Maya, ShopeePay, etc.</p>
                            </div>
                            
                            <div class="creat_account">
                                <input type="checkbox" id="f-option4" name="selector">
                                <label for="f-option4">I’ve read and accept the <a href="#">terms & conditions*</a></label>
                            </div>
                            
                            <div class="alert alert-warning" role="checkout-warning" id="checkout-warning" style="display: none;">
                                <p id="signuptextpass" style="text-align: center;">Please fill in all required fields.</p>
                           </div> 

                           <div class="alert alert-warning" role="checkout-done" id="checkout-done" style="display: none;">
                            <p id="signuptextpass" style="text-align: center;">Order placed successfully! Redirecting to confirmation page...</p>
                       </div> 

                            <a class="primary-btn" href="javascript:void(0)" id="ewalletpay" style="display: none">Proceed to Online Payment</a>
                            <a class="primary-btn" href="javascript:void(0)" id="checkpay" style="display: none">Pay Now</a>


                            
                            <script>
                                var checkPaymentRadio = document.getElementById("f-option5");
                                var ewalletPaymentRadio = document.getElementById("f-option7");
                                var ewalletpayButton = document.getElementById("ewalletpay");
                                var checkpayButton = document.getElementById("checkpay");
                            
                                checkPaymentRadio.addEventListener('change', function() {
                                    if (checkPaymentRadio.checked) {
                                        ewalletpayButton.style.display = "none";
                                        checkpayButton.style.display = "block";
                                    }
                                });
                            
                                ewalletPaymentRadio.addEventListener('change', function() {
                                    if (ewalletPaymentRadio.checked) {
                                        checkpayButton.style.display = "none";
                                        ewalletpayButton.style.display = "block";
                                    }
                                });
                            </script>
                            
                            <script>
                                //validate all fields before proceeding to payment

                            </script>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!--================End Checkout Area =================-->

    <!-- start footer Area -->
    <footer class="footer-area section_gap">
        <div class="container">
            <div class="row">
                <div class="col-lg-3  col-md-6 col-sm-6">
                    <div class="single-footer-widget">
                        <h6>About Us</h6>
                        <p>
                            Trendy Kicks is the leading footwear store in the Province of Rizal and NCR.
                        </p>
                    </div>
                </div>
                <div class="col-lg-4  col-md-6 col-sm-6">
                    <div class="single-footer-widget">
                        <h6>Newsletter</h6>
                        <p>Get in Touch With Us</p>
                        <div class="" id="mc_embed_signup">

                            <form target="_blank" novalidate="true" action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01"
                                method="get" class="form-inline">

                                <div class="d-flex flex-row">

                                    <input class="form-control" name="EMAIL" placeholder="Enter Email" onfocus="this.placeholder = ''"
                                        onblur="this.placeholder = 'Enter Email '" required="" type="email">


                                    <button class="click-btn btn btn-default"><i class="fa fa-long-arrow-right"
                                            aria-hidden="true"></i></button>
                                    <div style="position: absolute; left: -5000px;">
                                        <input name="b_36c4fd991d266f23781ded980_aefe40901a" tabindex="-1" value=""
                                            type="text">
                                    </div>

                                    <!-- <div class="col-lg-4 col-md-4">
													<button class="bb-btn btn"><span class="lnr lnr-arrow-right"></span></button>
												</div>  -->
                                </div>
                                <div class="info"></div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3  col-md-6 col-sm-6">
                    <div class="single-footer-widget mail-chimp">
                        <h6 class="mb-20">Facebook Feed</h6>
						<ul class="instafeed d-flex flex-wrap">
							<li><a href="https://www.facebook.com/permalink.php?story_fbid=pfbid02iaNKzhT5rQA87iHFxkrr4dHXPi3eKQBJwK7E4J2GWiG5zPFyDgVoaXQv91dK77DUl&id=100088232736873"><img src="img/sb1.png" alt=""></a></li>
							<li><a href="https://www.facebook.com/permalink.php?story_fbid=pfbid02iaNKzhT5rQA87iHFxkrr4dHXPi3eKQBJwK7E4J2GWiG5zPFyDgVoaXQv91dK77DUl&id=100088232736873"><img src="img/sb4.png" alt=""></a></li>
							<li><a href="https://www.facebook.com/permalink.php?story_fbid=pfbid02iaNKzhT5rQA87iHFxkrr4dHXPi3eKQBJwK7E4J2GWiG5zPFyDgVoaXQv91dK77DUl&id=100088232736873"><img src="img/sb6.png" alt=""></a></li>
							<li><a href="https://www.facebook.com/permalink.php?story_fbid=pfbid02iaNKzhT5rQA87iHFxkrr4dHXPi3eKQBJwK7E4J2GWiG5zPFyDgVoaXQv91dK77DUl&id=100088232736873"><img src="img/sb8.png" alt=""></a></li>
							<li><a href="https://www.facebook.com/permalink.php?story_fbid=pfbid02iaNKzhT5rQA87iHFxkrr4dHXPi3eKQBJwK7E4J2GWiG5zPFyDgVoaXQv91dK77DUl&id=100088232736873"><img src="img/sb9.png" alt=""></a></li>
							<li><a href="https://www.facebook.com/permalink.php?story_fbid=pfbid02iaNKzhT5rQA87iHFxkrr4dHXPi3eKQBJwK7E4J2GWiG5zPFyDgVoaXQv91dK77DUl&id=100088232736873"><img src="img/sb7.png" alt=""></a></li>
							<li><a href="https://www.facebook.com/permalink.php?story_fbid=pfbid02iaNKzhT5rQA87iHFxkrr4dHXPi3eKQBJwK7E4J2GWiG5zPFyDgVoaXQv91dK77DUl&id=100088232736873"><img src="img/sb2.png" alt=""></a></li>
							<li><a href="https://www.facebook.com/permalink.php?story_fbid=pfbid02iaNKzhT5rQA87iHFxkrr4dHXPi3eKQBJwK7E4J2GWiG5zPFyDgVoaXQv91dK77DUl&id=100088232736873"><img src="img/sb3.png" alt=""></a></li>
						</ul>
                    </div>
                </div>
                <div class="col-lg-2 col-md-6 col-sm-6">
                    <div class="single-footer-widget">
                        <h6>Follow Us</h6>
                        <p>Let us be social</p>
                        <div class="footer-social d-flex align-items-center">
                            <a href="#"><i class="fa fa-facebook"></i></a>
                            <a href="#"><i class="fa fa-twitter"></i></a>
                            <a href="#"><i class="fa fa-dribbble"></i></a>
                            <a href="#"><i class="fa fa-behance"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-bottom d-flex justify-content-center align-items-center flex-wrap">
                
            </div>
        </div>
    </footer>
    <!-- End footer Area -->

    <script>


        </script>

    <script src="js/vendor/jquery-2.2.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
        crossorigin="anonymous"></script>
    <script src="js/vendor/bootstrap.min.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/jquery.sticky.js"></script>
    <script src="js/nouislider.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <!--gmaps Js-->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCGmQ0Uq4exrzdcL6rvxywDDOvfAu6eE"></script>
    <script src="js/gmaps.min.js"></script>
    <script src="js/main.js"></script>

    
    <script type="module">
		// Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-analytics.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";
import { getDatabase, ref, get, set, push } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

		// TODO: Add SDKs for Firebase products that you want to use
		// https://firebase.google.com/docs/web/setup#available-libraries
	  
		// Your web app's Firebase configuration
		// For Firebase JS SDK v7.20.0 and later, measurementId is optional
		const firebaseConfig = {
		  apiKey: "AIzaSyA2FHdPmciDepMuSGvfjlMXLzVP2u0FLj8",
		  authDomain: "trendy-auth.firebaseapp.com",
		  databaseURL: "https://trendy-auth-default-rtdb.firebaseio.com",
		  projectId: "trendy-auth",
		  storageBucket: "trendy-auth.appspot.com",
		  messagingSenderId: "1098155513806",
		  appId: "1:1098155513806:web:3cf3d13be6f0292884fd9f",
		  measurementId: "G-9TDD84MPWK"
		};
	  
		// Initialize Firebase
		const app = initializeApp(firebaseConfig);
		const analytics = getAnalytics(app);
		const auth = getAuth(app);

		onAuthStateChanged(auth, function(user) {
    if (user) {

        // User is signed in.
		//alert("Welcome " + user.email);
        document.getElementById("returningCustomer").style.display = "none";
        document.getElementById("creat_account1").style.display = "none";

        var uid = user.uid;
    var db = getDatabase(app);
    var userRef = ref(db, 'users/' + uid + '/userData');
    
    get(userRef).then((snapshot) => {
        if (snapshot.exists()) {
            var userData = snapshot.val();
            
            document.getElementById("first").value = userData.first;
            document.getElementById("last").value = userData.last;
            document.getElementById("email").value = userData.email;
            document.getElementById("company").value = userData.company;
            document.getElementById("number").value = userData.number;
            document.getElementById("add1").value = userData.add1;
            document.getElementById("city").value = userData.city;
            document.getElementById("country1").value = userData.country1;
            document.getElementById("province").value = userData.province;
            document.getElementById("zip").value = userData.zip;
        } else {
            console.log("No data available");

        }
    }).catch((error) => {
        console.error(error);
    });
    
        //fill up email field with user email
        document.getElementById("email").value = user.email;
     } else {

        document.getElementById("returningCustomer").style.display = "block";
        document.getElementById("creat_account1").style.display = "block";

        //if cart is empty redirect to shop page
        window.location.href = "./Login with Registration/index.html";

    }
});

//check if cart is empty and redirect to shop page
const storedArray = JSON.parse(localStorage.getItem('cart'));

if (Array.isArray(storedArray) && storedArray.length > 0) {    
} else {
    window.location.href = "category.html";
}




document.getElementById("ewalletpay").addEventListener("click", function() {
    var cart = JSON.parse(localStorage.getItem("cart"));
    
    // Calculate the total price
    var total = cart.reduce(function(acc, item) {
        var price = parseFloat(item.price.replace(/,/g, ''));
        var quantity = item.quantity;
        return acc + (price * quantity);
    }, 0);
    
    var selectedCountry = document.getElementById("country1").value;
    var shippingCost = {
        "Philippines": 150,
        "India": 550,
        "Japan": 800
    }[selectedCountry] || 0;
    
    var totalWithShipping = total + shippingCost;
    
    console.log("Total without shipping: " + total);
    console.log("Shipping cost: " + shippingCost);
    console.log("Total with shipping: " + totalWithShipping);
    
    cart.forEach(function(order) {
        console.log(order.name);
    });
    
    var user = auth.currentUser;
    if (user) {
        var uid = user.uid;
        var db = getDatabase(app);
        
        var today = new Date();
        var todayFormatted = today.toISOString().split('T')[0];
        var userOrdersRef = ref(db, 'users/' + uid + '/orders/' + todayFormatted);
        
        var requiredFields = ["first", "last", "email", "country1", "company", "number", "add1", "city", "province", "zip"];
        var checkBoxterms = document.getElementById("f-option4");

        var isNotEmpty = function(id) {
            return document.getElementById(id).value.trim() !== '';
        };
        
        if (requiredFields.every(isNotEmpty) && checkBoxterms.checked == true) {
            cart.forEach(function(order, index) {
                var newOrderRef = push(userOrdersRef);
                var priceWithoutCommas = parseFloat(order.price.replace(/,/g, ''));
                var today = new Date();
                var todayFormatted = today.toISOString().split('T')[0];

                if (!isNaN(priceWithoutCommas)) {
                    var orderData = {
                    name: order.name,
                    price: priceWithoutCommas,
                    subtotal: priceWithoutCommas * order.quantity,
                    quantity: order.quantity,
                    shippingCost: shippingCost,
                    paymentMethod: "E-Wallet",
                    orderStatus: "Pending",
                    shippingAddress: document.getElementById("add1").value + ', ' +
                                    document.getElementById("city").value + ', ' +
                                    document.getElementById("province").value + ', ' +
                                    document.getElementById("zip").value + ', ' +
                                    document.getElementById("country1").value,
                    lastUpdated: todayFormatted
                };

                    orderData.totalPrice = (priceWithoutCommas * order.quantity) + shippingCost;
                    document.getElementById("checkout-done").style.color="#155724";
    document.getElementById("checkout-done").style.backgroundColor="#d4edda";
    document.getElementById("checkout-done").style.borderColor="#c3e6cb";
    document.getElementById('signuptextpass').innerText = 'Order placed successfully! Redirecting to confirmation page...'
    document.getElementById("checkout-done").style.display = "block";
    document.getElementById("checkout-warning").style.display = "none";

    localStorage.setItem("paymentM", "E-Wallet");
    var today = new Date();
    var todayFormatted = today.toISOString().split('T')[0];
    localStorage.setItem("orderDate", todayFormatted);
    localStorage.setItem("totalPayment", totalWithShipping);


    setTimeout(function() {
        window.location.href = "confirmation.html";
        localStorage.removeItem("cart");
    }, 3000);

                    set(newOrderRef, orderData, function(error) {
                        if (error) {
                            console.error('Error writing order ' + index + ' to Firebase: ', error);
                        } else {
                            console.log('Order ' + index + ' written to Firebase with ID: ', newOrderRef.key);
                        }
                    });
                } else {
                    console.error('Invalid numeric values in order data.');
                }
            });
        } else {
            document.getElementById("checkout-done").style.display = "none";
            document.getElementById('signuptextpass').innerText = 'Please fill in all required field2s.'
            document.getElementById("checkout-warning").style.display = "block";
            
            setTimeout(function() {
    document.getElementById("checkout-warning").style.display = "none";
}, 4000);
        } 
    } else {
        console.error('User is not logged in.');
    }
});


//save user data to the database
function saveUserData() {
    var requiredFields = ["first", "last", "email", "company", "country1", "number", "add1", "city", "province", "zip"];
    var checkBoxterms = document.getElementById("f-option4");

    var isNotEmpty = function(id) {
        return document.getElementById(id).value.trim() !== '';
    };
    
    if (requiredFields.every(isNotEmpty) && checkBoxterms.checked == true) {
        var user = auth.currentUser;
        if (user) {
            var uid = user.uid;
            var db = getDatabase(app);
            
            var userData = {};
            requiredFields.forEach(function(id) {
                userData[id] = document.getElementById(id).value;
            });
            
            var userRef = ref(db, 'users/' + uid + '/userData');
            
            set(userRef, userData, function(error) {
                if (error) {
                    console.error('Error writing user data to Firebase: ', error);
                } else {
                    console.log('User data written to Firebase with ID: ', userRef.key);
                }
            });
        } else {
            console.error('User is not logged in.');
        }
    } else if (checkBoxterms.checked == false) {
        document.getElementById("checkout-done").style.display = "none";
        document.getElementById('signuptextpass').innerText = 'Please read & accept the terms and conditions.'
                document.getElementById("checkout-warning").style.display = "block";
                setTimeout(function() {
    document.getElementById("checkout-warning").style.display = "none";
}, 1000);

    } else {
        document.getElementById("checkout-done").style.display = "none";
        document.getElementById('signuptextpass').innerText = 'Please fill in all required fields.'
        document.getElementById("checkout-warning").style.display = "block";
    }
}

document.getElementById("ewalletpay").addEventListener("click", saveUserData);
setTimeout(function() {
    document.getElementById("checkout-warning").style.display = "none";
}, 4000);


onAuthStateChanged(auth, function (user) {
  if (user) {
    var uid = user.uid;
	
	//profilevisit on click
	var profilevisit = document.getElementById("profilevisit");
	profilevisit.addEventListener("click", function() {
		window.location.href = "./Customer/user-profile.html";
	});
} else {
	var profilevisit = document.getElementById("profilevisit");
	profilevisit.addEventListener("click", function() {
		window.location.href = "./Login With Registration/index.html";
	});
}
});

	  </script>

</body>

</html>